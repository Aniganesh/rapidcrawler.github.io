<!DOCTYPE html>
<html>

<head>
    <script type='text/javascript'
        src='https://platform-api.sharethis.com/js/sharethis.js#property=61684b19e876080012645f8a&product=sop'
        async='async'></script>
    <!-- NavBar . Also copy the part from start of <body> tag below -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(function () {
            $("#nav_bar_dark").load("/assets/scripts/nav_bar_dark.html");
        });
    </script>

    <title>Juspreet51.in</title>

    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/nav_bar_dark_style.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/blog_posts_style.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/blog_posts_style.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/button_style.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/css_dark_mode_gist_embed_code.css">

    <!-- Google Fonts: Robot Black 900-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=+2:wght@900&display=swap" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>

<body>
    <!-- NavBar . Also copy the part from start of <head> tag above -->
    <div id="nav_bar_dark"></div>

    <div class="three_col_layout">

        <!-- ####################
    LHS Sidebar needs update
    #################### -->
        <div class="column_left">
            <h2 style="text-align: center;"> Chapters </h2>
            <a href="/blog/langs/SQL/basics">1) Server Setup</a> <br>
            <a href="#">2) Basic Querying</a> <br>
            <a href="#groupby">3) Window Functions</a> <br>
            <a href="/blog/langs/SQL/common_interview_questions">4) Interview Questions</a>
        </div>

        <!-- ####################
    Page Titke needs update
    #################### -->
        <div class="column_center">
            <h1>SQL Language</h1>
            <div class="meta_info">
                <span style="float: left;">
                    <p>
                        <!-- ####################
              Date-Posted needs update
              #################### -->
                        Posted by: <a href="/blog/home" target="_blank" class="blog_links">Juspreet51</a>
                    </p>
                </span>
                <span style="float: right;">
                    <p>
                        Last Updated on: 09 Oct, 2021
                    </p>
                </span>
            </div>


            <!-- ####################
        Banner img needs update
        #################### -->
            <div class="banner">
                <img src="/assets/imgs/banners/SQL_windows.png">
            </div>

            <br>

            <div class="share_this_plugin">
                <br>
                <!-- Footer . Also copy the part from start of <head> tag above -->
                <div class="sharethis-inline-share-buttons"></div>
            </div>

            <h1>Window Functions</h1>
            <hr>
            <div class="toc">
                <h1>Table of Contents</h1>
                <a href="#groupby">1) GroupBy</a> <br>
                <a href="#over">2) Over</a> <br>
                <a href="#footer">3) Interview Questions</a>
            </div>
            <hr>

            <div class="blog_content">
                <br>

                <h1>Create A Practice Database in SSMS</h1>
                To install MS SSMS visit the <a href="/blog/langs/SQL/setup">installation page</a> for details on
                downloading and installation
                <img src="/assets/imgs/blog/sql/CreateDatabase_01.png" alt="" style="width: 85%;">
                <script
                    src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=SQLPractice_DB_Creation.sql"></script>

                <br>

                <h1>Insert Records Into Newly Created Tables</h1>

                Run the below query to create the database we would be working on:

                Run the below provided query to create the table we would be working on:
                <script
                    src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=Win_Func_Practice_creation.sql"></script>
                <br>
                <img src="/assets/imgs/blog/sql/CreateDatabase_02.PNG" alt="" style="width: 45%;">


                <div id="groupby">
                    <h1>1) GroupBy</h1>
                    <p>
                        <script
                            src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=groupby.sql"></script>
                        <br>
                        When using <i>Group By</i> for a column, for each unique entry in that column, the aggregate
                        function is applied
                        <img src="/assets/imgs/blog/sql/groupby_01.PNG" alt="" style="width: 85%;">
                        <br>
                        Pay attention, to use groupby, we need to use Aggregate function for rest of the columns
                        mentioned
                        in the SELECT statement <br>
                        But, if we had to <i>Group By</i> at State, and display individual PersonalId, with applying
                        aggregator, groupby would throw and error
                        <br>
                        Here, <i>OVER()</i> comes to rescue here
                    </p>
                    <p>
                    <h1 id="over">Over</h1>
                    <img src="/assets/imgs/blog/sql/groupby_02.PNG" alt="" style="width: 85%;">
                    <br>
                    <script
                        src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=over.sql"></script>
                    <br>
                    <!-- <img src="/assets/imgs/blog/sql/groupby_04.PNG" alt="" style="width: 85%;">
                        <br> -->
                    <img src="/assets/imgs/blog/sql/groupby_05.PNG" alt="" style="width: 85%;">
                    <br>

                    Here average_weight is recomputed on each 'step' of the SQL output
                    <img src="/assets/imgs/blog/sql/window_functions_02_1.png" alt="" style="width: 75%;">
                    <i class="img_credit">Credits: <a
                            href="https://www.windowfunctions.com/questions/intro/">windowfunctions.com</a>
                    </i> <br>


                    <i>OVER()</i> is useful in limiting or tweaking the data returned from aggregate Functions
                    <br><br>

                    </p>
                </div>


                <h1 id=partition>Partition by</h1>
                <h3>Good video to begin with:</h3>
                <iframe width="95%" height="320px" src="https://www.youtube.com/embed/D6XNlTfglW4"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
                More vides from the same <a
                    href="https://www.youtube.com/playlist?list=PLUaB-1hjhk8HTgPnBukmMq7QTe83ANirL">playlist</a>

                <p>
                    <script
                        src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=partition_by.sql"></script>
                    <br>
                    <img src="/assets/imgs/blog/sql/groupby_06.PNG" alt="" style="width: 98%;">
                </p>
                <p>
                    <img src="/assets/imgs/blog/sql/window_functions_00_2.png" alt="" style="width: 98%;">
                    <i class="img_credit">
                        Credits: <a href="https://www.windowfunctions.com/questions/intro/">windowfunctions.com </a>
                    </i>
                    <br>
                    What is going on here is:
                <ol>
                    <li>Of the whole dataset, create chunks of partition, on Countries
                        <img src="/assets/imgs/blog/sql/window_functions_00_3.JPG" alt="" style="width: 98%;">
                    </li>
                    <li>For those individual chunks, calculate <br>
                        <i>avg(weight) over (order by name)</i>
                        <img src="/assets/imgs/blog/sql/window_functions_00_4.JPG" alt="" style="width: 98%;">
                    </li>
                    <li>Order by name
                        <img src="/assets/imgs/blog/sql/window_functions_00_5.JPG" alt="" style="width: 98%;">
                    </li>
                </ol>
                </p>
                <h1>Preceding and Following</h1>
                <p>
                    <img src="/assets/imgs/blog/sql/window_functions_00_6.JPG" alt="" style="width: 98%;">
                    <i class="img_credit">
                        Credits: <a href="https://www.windowfunctions.com/questions/intro/">windowfunctions.com </a>
                    </i>
                    <script
                        src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=preceeding.sql"></script>
                    <br>
                    <img src="/assets/imgs/blog/sql/groupby_08.PNG" alt="" style="width: 98%;">
                    <br>
                </p>
                <hr>
                <p id="unbounded_preceding">
                <h3>Unbounded Preceding</h3>
                <a href="https://www.windowfunctions.com/questions/over/3">Question</a>: The cats must be
                ordered by weight descending and will enter an elevator one by one. We would like to know what
                the running total weight is. <br>
                * If two cats have the same weight they must enter separately <a
                    href="https://www.windowfunctions.com/questions/over/3">(source)</a>
                <br>
                </p>
                <div>
                    <span>
                        <img src="/assets/imgs/blog/sql/window_functions_00_8_0.JPG" alt=""
                            style="width: 49%; float: left;">
                    </span>
                    <span>
                        <img src="/assets/imgs/blog/sql/window_functions_00_8_1.JPG" alt=""
                            style="width: 49%; float: right;">
                    </span>

                    <br><br><br><br>

                </div>

                <div style="height: 50px;">
                    <h1 style="opacity: 0.1%;">.</h1>
                    <h1 style="opacity: 0.1%;">.</h1>
                </div>

                <br><br><br><br><br><br><br>
                <div>
                    <p>
                        <br>
                        <b>Solution</b>:
                        <script
                            src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=unbounded_preceding.sql"></script>
                        <br>
                    </p>
                </div>


                <div id="ranking">
                    <h1>Row Number, Rank & Dense Rank</h1>
                    <p>
                        <img src="/assets/imgs/blog/sql/groupby_09.PNG" alt="" style="width: 75%;">
                        <br>
                        <script
                            src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=rank.sql"></script>
                        <br>
                    </p>

                    <h1>Cume Dist & Percent Rank </h1>
                    <p>
                    <ul>
                        <li> <b>percent_rank</b> returns a number from 1 to 0. The highest being 1 and the lowest 0</li>
                        <li> <b>cume_dist</b> will return a number from 1 towards 0 but never 0</li>
                    </ul>
                    <script
                        src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=percent_rank.sql"></script>
                    <br>
                    <img src="/assets/imgs/blog/sql/groupby_10.PNG" alt="" style="width: 75%;">
                    </p>
                </div>

                <div id="grouping">
                    <h1>Grouping</h1>
                    <p>
                        <b>Lag and Lead</b>: These functions allow you to examine the next or previous row, may then
                        compare this value to the current row
                        <script
                            src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=lag_lead.sql"></script>
                        <br>
                        <img src="/assets/imgs/blog/sql/groupby_11.PNG" alt="" style="width: 75%;">
                    </p>
                    <p>
                        <b>nth_value</b>: Gives the nth-value, after the current row
                        <br>
                        nth_value will return the nth_value, but if we do not specify a range it will
                        return null if the current value is less than the nth. If we always want something displayed we
                        need to specify a range

                        <br><br>

                        <b>ntile</b>: ntile(n) divides the group into n equal partitions and denotes which partition
                        each row is in
                        <br>
                        <img src="/assets/imgs/blog/sql/window_functions_06.JPG" alt="" style="width: 98%;">
                        <i class="img_credit">Credits: <a
                                href="https://www.windowfunctions.com/questions/intro/">windowfunctions.com</a>
                        </i> <br>
                        <script
                            src="https://gist.github.com/juspreet51/d6a453950bcd3b459cfbbf612e4bb025.js?file=nth_ntile.sql"></script>
                        <br>
                    </p>
                </div>
            </div>
        </div>

        <div class="column_right">
            <!-- <h2 style="text-align: center;"> Topics </h2>
      <a href="#basics">a) Basics</a> <br>
      <a href="#sample">b) Distributions</a> <br>
      <a href="#summary">c) Data Summary</a> <br>
      <a href="#distribution">d)Shape of Distribution</a> <br> -->
        </div>
        <!-- ########################################### -->
        <!-- ############## RHS Sidebar ################ -->
        <!-- ########################################### -->

    </div>
    <!-- ################################################### -->
    <!-- ############ three_col_layout Ends Here ########### -->
    <!-- ################################################### -->

    <div style="height: 50px;">
        <h1></h1>
    </div>

    <div class="footer">
        <div id="page_change_btns">
            <a href="#">
                <button class="pagination_button previous_button" style="vertical-align:middle;">
                    <span>Previous </span>
                </button>
            </a>

            <!-- ####################
                Link in nxt-btn needs update
                #################### -->
            <a href="/blog/langs/SQL/common_interview_questions">
                <button class="pagination_button next_button" style="">
                    <span>Interview Questions </span>
                </button>
            </a>
        </div>
        <br> <br> <br> <br>
        <div class="share_this_plugin">
            <h1>Share This</h1>
            <p>Share it with your friends and colleagues whom you think it can help</p>
            <!-- Footer . Also copy the part from start of <head> tag above -->
            <div class="sharethis-inline-share-buttons"></div>
        </div>

        <div class="comment_box">
            <!-- ########################################### -->
            <!-- ############# Needs updates ############### -->
            <!-- ########################################### -->
            <!-- begin wwww.htmlcommentbox.com -->
            <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comment Box</a> is loading comments...
            </div>
            <link rel="stylesheet" type="text/css"
                href="https://www.htmlcommentbox.com/static/skins/bootstrap/twitter-bootstrap.css?v=0" />
            <script type="text/javascript"
                id="hcb"> /*<!--*/ if (!window.hcb_user) { hcb_user = {}; } hcb_user.PAGE = "https://juspreet51.github.io/blog/deep_learning/network_understanding_basic"; (function () { var s = document.createElement("script"), l = hcb_user.PAGE || ("" + window.location).replace(/'/g, "%27"), h = "https://www.htmlcommentbox.com"; s.setAttribute("type", "text/javascript"); s.setAttribute("src", h + "/jread?page=" + encodeURIComponent(l).replace("+", "%2B") + "&mod=%241%24wq1rdBcg%24WGLJ0qbFjhsr.BXys0KRJ%2F" + "&opts=16406&num=5&ts=1633641065176"); if (typeof s != "undefined") document.getElementsByTagName("head")[0].appendChild(s); })(); /*-->*/</script>
            <!-- end www.htmlcommentbox.com -->
        </div>

    </div>

</body>

</html>